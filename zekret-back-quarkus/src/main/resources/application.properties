# =============================================================================
# CONFIGURACIÓN DE APLICACIÓN QUARKUS
# =============================================================================

# -----------------------------------------------------------------------------
# HTTP SERVER CONFIGURATION
# Configuración del servidor HTTP
# -----------------------------------------------------------------------------
# Puerto en el que se ejecuta la aplicación
quarkus.http.port=8080

# -----------------------------------------------------------------------------
# CORS CONFIGURATION
# Configuración de CORS (Cross-Origin Resource Sharing)
# -----------------------------------------------------------------------------
# CORS para desarrollo - permite conexiones desde frontend local
%dev.quarkus.http.cors.origins=http://localhost:4200,http://127.0.0.1:4200
%dev.quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
%dev.quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS

# CORS para producción - dominio específico
%prod.quarkus.http.cors.origins=https://creaconfortperu.com,https://www.zekret.com
%prod.quarkus.http.cors.headers=accept,authorization,content-type
%prod.quarkus.http.cors.methods=GET,POST,PUT,DELETE

#-----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# Configuraci\u00f3n de base de datos MySQL
# -----------------------------------------------------------------------------
# Tipo de base de datos
quarkus.datasource.db-kind=mysql
# URL de conexi\u00f3n a MySQL
quarkus.datasource.jdbc.url=${DATASOURCE_URL:jdbc:mysql://localhost:3306/zekretdb}
# Credenciales de conexi\u00f3n
quarkus.datasource.username=${MYSQL_USER:root}
quarkus.datasource.password=${MYSQL_PASSWORD:root}
# Tama\u00f1o m\u00e1ximo del pool de conexiones
quarkus.datasource.jdbc.max-size=20

# -----------------------------------------------------------------------------
# HIBERNATE ORM CONFIGURATION
# Configuraci\u00f3n de Hibernate para desarrollo
# -----------------------------------------------------------------------------
# Estrategia de actualización de BD
quarkus.hibernate-orm.database.generation=update

# Naming strategy para compatibilidad con BD existente
quarkus.hibernate-orm.physical-naming-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# Configuración de desarrollo
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.hibernate-orm.validate-in-dev-mode=false

# =====================================
# JWT SECURITY (REQUERIDO)
# =====================================
# SmallRye JWT Configuration

# DESARROLLO: Keys locales (fuera del proyecto)
%dev.mp.jwt.verify.publickey.location=${JWT_PUBLIC_KEY_PATH}
%dev.smallrye.jwt.sign.key.location=${JWT_PRIVATE_KEY_PATH}

# TESTING: Keys temporales para tests
%test.mp.jwt.verify.publickey.location=${JWT_PUBLIC_KEY_PATH}
%test.smallrye.jwt.sign.key.location=${JWT_PRIVATE_KEY_PATH}

# PRODUCCIÓN: Keys desde variables de entorno (OBLIGATORIO)
%prod.mp.jwt.verify.publickey.location=${JWT_PUBLIC_KEY_PATH}
%prod.smallrye.jwt.sign.key.location=${JWT_PRIVATE_KEY_PATH}

# JWT Issuer y configuración común
mp.jwt.verify.issuer=https://zekret.com
jwt.expiration.time=3600

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# Configuración de logs de la aplicación
# -----------------------------------------------------------------------------
# Formato de logs en consola
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Niveles de log por ambiente
%dev.quarkus.log.console.level=DEBUG
%prod.quarkus.log.console.level=INFO

# Configuración de logs en archivo
quarkus.log.file.enable=true
quarkus.log.file.path=${APP_PATH:.}/logs/app.log
quarkus.log.file.level=INFO

# Rotación de archivos de log
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=5

# Niveles de log en archivo por ambiente
%dev.quarkus.log.file.level=DEBUG
%test.quarkus.log.file.enable=false
%prod.quarkus.log.file.level=INFO

# -----------------------------------------------------------------------------
# NATIVE BUILD CONFIGURATION
# Configuración para compilación nativa con GraalVM
# -----------------------------------------------------------------------------
# Construir imagen nativa usando contenedor
quarkus.native.container-build=true
# Imagen de construcción nativa con Mandrel JDK 21
quarkus.native.builder-image=quay.io/quarkus/ubi9-quarkus-mandrel-builder-image:jdk-21
# Runtime de contenedor para construcción nativa
quarkus.native.container-runtime=docker

# Para perfil Docker, no usar construcción en contenedor
%docker.quarkus.native.container-build=false

# Recursos a incluir en la imagen nativa
quarkus.native.resources.includes=config/**,static/**,templates/**,META-INF/resources/**

# Configuraciones de handlers y encoding para imagen nativa
quarkus.native.enable-http-url-handler=true
quarkus.native.enable-https-url-handler=true
quarkus.native.file-encoding=UTF-8

# Optimizaciones para imagen nativa
quarkus.native.add-all-charsets=false
quarkus.native.report-errors-at-runtime=false

# Debug para desarrollo con imagen nativa
%dev.quarkus.native.debug.enabled=true